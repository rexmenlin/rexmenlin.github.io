"use strict";(self.webpackChunkmy_site=self.webpackChunkmy_site||[]).push([[2909],{9820:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"finance-bank-api/Day06 - \u5b89\u5168\u7c3d\u7ae0\u7c3d\u4e0b\u53bb\uff0cAPI\u547c\u53eb\u6c92\u5728\u6015","title":"Day06 - \u5b89\u5168\u7c3d\u7ae0\u7c3d\u4e0b\u53bb\uff0cAPI\u547c\u53eb\u6c92\u5728\u6015","description":"\u5728\u6628\u5929\u8b1b\u5b8c\u4e86Message\u7684\u5bc6\u6587\u7522\u751f\u7d30\u7bc0\u6d41\u7a0b\u5f8c\uff0c\u56de\u904e\u982d\u4f86\u6211\u518d\u4f86\u8ac7Sign\u5b89\u5168\u7c3d\u7ae0\uff0c\u6211\u8a8d\u70ba\u9019\u9806\u5e8f\u6bd4\u8f03\u5bb9\u6613\u7406\u89e3\u3002\u5176\u5be6\u9019\u6574\u6bb5API\u7684\u547c\u53eb\uff0c\u53ef\u5206\u70ba\u5e7e\u500b\u8981\u7d20\uff1a","source":"@site/docs/finance-bank-api/Day06 - \u5b89\u5168\u7c3d\u7ae0\u7c3d\u4e0b\u53bb\uff0cAPI\u547c\u53eb\u6c92\u5728\u6015.md","sourceDirName":"finance-bank-api","slug":"/finance-bank-api/Day06 - \u5b89\u5168\u7c3d\u7ae0\u7c3d\u4e0b\u53bb\uff0cAPI\u547c\u53eb\u6c92\u5728\u6015","permalink":"/docs/finance-bank-api/Day06 - \u5b89\u5168\u7c3d\u7ae0\u7c3d\u4e0b\u53bb\uff0cAPI\u547c\u53eb\u6c92\u5728\u6015","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"tutorialSidebar","previous":{"title":"Day05 - \u7e7c\u7e8c\u628a\u52a0\u5bc6\u9019\u4ef6\u4e8b\u770b\u4e0b\u53bb","permalink":"/docs/finance-bank-api/Day05 - \u7e7c\u7e8c\u628a\u52a0\u5bc6\u9019\u4ef6\u4e8b\u770b\u4e0b\u53bb"},"next":{"title":"Day07 - \u6dfa\u8ac7binary\u8207\u5341\u516d\u9032\u4f4dHex\u3001UTF-8\u6587\u5b57\u7de8\u78bc\u8f49\u63db","permalink":"/docs/finance-bank-api/Day07 - \u6dfa\u8ac7binary\u8207\u5341\u516d\u9032\u4f4dHex\u3001UTF-8\u6587\u5b57\u7de8\u78bc\u8f49\u63db"}}');var i=r(4848),t=r(8453);const a={sidebar_position:7},l=void 0,o={},c=[{value:"\u63a5\u6536\u7aef\u5982\u4f55\u4f5c\u9a57\u8b49\uff1f",id:"\u63a5\u6536\u7aef\u5982\u4f55\u4f5c\u9a57\u8b49",level:3},{value:"\u8aaa\u4e86\u9019\u9ebc\u591a\uff0c\u4f86\u5be6\u4f5c\u5427",id:"\u8aaa\u4e86\u9019\u9ebc\u591a\u4f86\u5be6\u4f5c\u5427",level:3},{value:"\u300c\u8a0a\u606f\u5167\u6587\u300d\u9700\u8981\u52a0\u5de5\u4e00\u4e0b",id:"\u8a0a\u606f\u5167\u6587\u9700\u8981\u52a0\u5de5\u4e00\u4e0b",level:4},{value:"\u7a0b\u5f0f\u8aaa\u660e",id:"\u7a0b\u5f0f\u8aaa\u660e",level:5},{value:"\u5f8c\u9762\u9084\u6709\u5169\u500b\u8ddf\u5c41\u87f2",id:"\u5f8c\u9762\u9084\u6709\u5169\u500b\u8ddf\u5c41\u87f2",level:4},{value:"\u7a0b\u5f0f\u8aaa\u660e",id:"\u7a0b\u5f0f\u8aaa\u660e-1",level:5},{value:"\u7d42\u65bc\u628aAPI\u524d\u7f6e\u6240\u9700\u6e96\u5099\u597d\u4e86",id:"\u7d42\u65bc\u628aapi\u524d\u7f6e\u6240\u9700\u6e96\u5099\u597d\u4e86",level:3}];function d(e){const n={blockquote:"blockquote",code:"code",del:"del",h3:"h3",h4:"h4",h5:"h5",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["\u5728\u6628\u5929\u8b1b\u5b8c\u4e86",(0,i.jsx)(n.code,{children:"Message"}),"\u7684\u5bc6\u6587\u7522\u751f\u7d30\u7bc0\u6d41\u7a0b\u5f8c\uff0c\u56de\u904e\u982d\u4f86\u6211\u518d\u4f86\u8ac7",(0,i.jsx)(n.code,{children:"Sign"}),"\u5b89\u5168\u7c3d\u7ae0\uff0c\u6211\u8a8d\u70ba\u9019\u9806\u5e8f\u6bd4\u8f03\u5bb9\u6613\u7406\u89e3\u3002\u5176\u5be6\u9019\u6574\u6bb5API\u7684\u547c\u53eb\uff0c\u53ef\u5206\u70ba\u5e7e\u500b\u8981\u7d20\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u6e9d\u901a\u771f\u6b63\u7684\u4e3b\u9ad4\uff1a",(0,i.jsx)(n.strong,{children:"\u8a0a\u606f\u5167\u6587"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u6a5f\u5bc6\u76ee\u6a191\uff1a \u4e0d\u53ef\u88ab\u6709\u5fc3\u4eba\u58eb\u6514\u622a\u8a0a\u606f\uff1b\u5373\u4f7f\u88ab\u6514\u622a\u4e86\uff0c\u4e5f\u8981\u78ba\u4fdd\u8a0a\u606f\u5167\u5bb9\u4e0d\u88ab\u89e3\u6790\u3002\n\u82e5\u7121\u6cd5\u9054\u6210\uff0c\u6703\u9020\u6210\u4ee5\u4e0b\u554f\u984c\uff1a","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u6a5f\u654f\u8a0a\u606f\u88ab\u4ed6\u4eba\u53d6\u5f97"}),"\n",(0,i.jsxs)(n.li,{children:["\u8a0a\u606f\u88ab\u795e\u4e0d\u77e5\u9b3c\u4e0d\u89ba\u5730\u7be1\u6539\u8207\u91cd\u9001\n\u89e3\u6c7a\u65b9\u6cd5\uff1a\u5c07\u8a0a\u606f\u5167\u6587\u9032\u884c",(0,i.jsx)(n.strong,{children:"\u52a0\u5bc6"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u6a5f\u5bc6\u76ee\u6a192\uff1a \u82e5\u4e0d\u5e78\u8a0a\u606f\u88ab\u6514\u622a\u3001\u7834\u89e3\u3001\u7be1\u6539\u6216\u9001\u91cd\uff0c\u8981\u80fd\u5920\u6709\u6a5f\u5236\u9a57\u8b49\u8207\u8b58\u5225\u51fa\u4f86\u3002","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u9700\u5c07",(0,i.jsx)(n.code,{children:"\u8a0a\u606f\u5167\u6587"}),"\u4ee5\u53ca\u4e0a\u8ff0\u4f5cAES\u52a0\u5bc6\u7684",(0,i.jsx)(n.code,{children:"AES Key"}),"\u8207",(0,i.jsx)(n.code,{children:"IV"}),"\u7684",(0,i.jsx)(n.strong,{children:"\u7522\u751f\u4f9d\u64da"})," (\u4e5f\u5c31\u662f\u4e26\u975e\u76f4\u63a5\u62ff\u91d1\u9470\u6216IV\u4f86\u904b\u7528)\uff0c\u7531API\u7aef\u8b1b\u5b9a\u898f\u5247\uff0c\u5c07\u4e0a\u8ff0\u8981\u7d20\u900f\u904e\u5b89\u5168\u96dc\u6e4a\u7684\u6f14\u7b97\u6cd5\u7522\u751f\u6578\u4f4d\u7c3d\u7ae0\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u63a5\u6536\u7aef\u5982\u4f55\u4f5c\u9a57\u8b49",children:"\u63a5\u6536\u7aef\u5982\u4f55\u4f5c\u9a57\u8b49\uff1f"}),"\n",(0,i.jsxs)(n.p,{children:["\u7531\u50b3\u9001\u7aef(\u5546\u5bb6)\u4f9d\u898f\u5247\u8207\u91cd\u8981\u5143\u7d20\u7522\u751f\u7684\u6578\u4f4d\u7c3d\u7ae0\uff0c\n\u7576\u5546\u5bb6\u547c\u53ebAPI\u6642\uff0c\u5148\u524d\u5df2\u7d93\u7d93\u7531AES\u5c0d\u7a31\u52a0\u5bc6\u6cd5\u7522\u751f\u51fa\u5bc6\u6587",(0,i.jsx)(n.code,{children:"Message"}),"\uff0c\u56e0\u6b64\u63a5\u6536\u7aef(\u6c38\u8c50API)\u7576\u7136\u6709\u8207\u52a0\u5bc6\u76f8\u540c\u7684",(0,i.jsx)(n.code,{children:"AES Key"}),"\u4f86\u5c0d\u5bc6\u6587\u4f5c\u89e3\u5bc6\u3002\u56e0\u6b64\u63a5\u6536\u7aef\u76ee\u524d\u53ef\u5f9e\u4e2d\u53d6\u51fa",(0,i.jsx)(n.code,{children:"\u8a0a\u606f\u5167\u6587"}),"\u7684\u660e\u6587\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u63a5\u8457\uff0c\u6c38\u8c50API\u6703\u53e6\u5916\u6536\u5230\u4e00\u500b\u5b89\u5168\u7c3d\u7ae0",(0,i.jsx)(n.code,{children:"Sign"}),"\uff0c\u9084\u8a18\u5f97\u7576\u521d\u662f\u5982\u4f55\u7522\u751f\u9019\u500b",(0,i.jsx)(n.code,{children:"Sign"}),"\u7684\u65b9\u6cd5\u55ce\uff1f\n\u518d\u8907\u7fd2\u4e00\u6b21\uff1a\u300c\u9700\u5c07",(0,i.jsx)(n.code,{children:"\u8a0a\u606f\u5167\u6587"}),"\u4ee5\u53ca\u4e0a\u8ff0\u4f5cAES\u52a0\u5bc6\u7684",(0,i.jsx)(n.code,{children:"AES Key"}),"\u8207",(0,i.jsx)(n.code,{children:"IV"}),"\u7684",(0,i.jsx)(n.strong,{children:"\u7522\u751f\u4f9d\u64da"})," (\u4e5f\u5c31\u662f\u4e26\u975e\u76f4\u63a5\u62ff\u91d1\u9470\u6216IV\u4f86\u904b\u7528)\uff0c\u7531API\u7aef\u8b1b\u5b9a\u898f\u5247\uff0c\u5c07\u4e0a\u8ff0\u8981\u7d20\u900f\u904e\u5b89\u5168\u96dc\u6e4a\u7684\u6f14\u7b97\u6cd5\u7522\u751f\u6578\u4f4d\u7c3d\u7ae0\u3002\u300d"]}),"\n",(0,i.jsxs)(n.p,{children:["\u525b\u525b\u5df2\u7d93\u5f9eAES\u89e3\u5bc6\u62ff\u56de",(0,i.jsx)(n.code,{children:"\u8a0a\u606f\u5167\u6587"}),"\u4e86\uff0c\u90a3\u5269\u4e0b\u7684",(0,i.jsx)(n.strong,{children:"\u7522\u751f\u4f9d\u64da"}),"\uff0c\u65e2\u7136\u7576\u521d\u9019\u4e9b\u90fd\u662f\u6c38\u8c50\u63d0\u4f9b\u7684\uff0c\u4ed6\u5011\u7576\u7136\u90fd\u6709\u9019\u4e9b\u503c\u3002\u53ea\u9700\u8981\u4f9d\u64da\u8b1b\u597d\u7684\u898f\u5247\uff0c\u518d\u904b\u4f5c\u4e00\u6b21\uff0c\u7136\u5f8c\u300c",(0,i.jsx)(n.strong,{children:"\u6bd4\u5c0d\u9019\u500b\u525b\u525b\u505a\u51fa\u4f86\u7684Sign\u548c\u5546\u5bb6\u50b3\u4f86\u7684Sign\u662f\u5426\u76f8\u540c"}),"\u300d\u5373\u53ef\u3002(\u56e0\u70ba\u96dc\u6e4a\u6f14\u7b97\u6cd5\u662f\u4e0d\u53ef\u9006\u63a8\u7684\uff0c\u56e0\u6b64\u53ea\u9700\u6bd4\u5c0d\u7d50\u679c\u662f\u5426\u4e00\u6a23\u5c31\u597d)"]}),"\n",(0,i.jsx)(n.p,{children:"\u7576\u7136\uff0c\u5176\u4e2d\u9084\u6703\u6709\u6a5f\u5236\u53bb\u591a\u6bd4\u5c0dNonce\u503c\u662f\u5426\u5728\u6548\u671f\u5167\uff0c\u4ee5\u53ca\u662f\u5426\u88ab\u91cd\u8986\u4f7f\u7528\u904e\uff0c\u751a\u81f3\u5224\u65b7\u662f\u5426\u70ba\u5546\u5bb6\u7684IP\u7b49\u3002\u9019\u4e9b\u4e0a\u9762\u8aaa\u660e\u7684\u6240\u6709\u4f5c\u6cd5\u7684\u76ee\u7684\uff0c\u90fd\u662f\u70ba\u4e86\u9a57\u8b49\u4e00\u4ef6\u4e8b\uff1a\n\u300c\u5373\u4f7fAPI\u6536\u5230\u4e86\u4e00\u500b\u5bc6\u6587\uff0c\u4e5f\u9806\u5229\u89e3\u958b\uff0c\u770b\u8d77\u4f86\u4e5f\u5f88\u5408\u7406\u7684\u5167\u5bb9\uff0c\u5230\u5e95\u662f\u4e0d\u662f\u8a72\u5546\u5bb6\u50b3\u4f86\u7684\u300d"}),"\n",(0,i.jsxs)(n.p,{children:["\u4f46\u6709\u4e00\u500b\u5f88\u91cd\u8981\u7684\u524d\u63d0\u662f\uff0c\u5546\u5bb6\u6709\u597d\u597d\u4fdd\u8b77\u81ea\u5df1\u7684\u6a5f\u654f\u8a0a\u606f\uff1a",(0,i.jsx)(n.strong,{children:"\u90a34\u500b\u9700\u8981\u62fc\u4e86\u547d\u4fdd\u8b77\u4e0d\u53ef\u6d29\u6f0f\u7684Hash\u4ee3\u78bc\u3002"}),"\n\u96d6\u7136\u5546\u5e97\u7de8\u865f(ShopNo)\u4e5f\u5f88\u91cd\u8981\uff0c\u56e0\u70ba\u6709\u9019\u500b\u5c31\u53ef\u4ee5\u900f\u904eAPI\u554f\u5230Nonce\u503c\uff0c\u4f46\u6211\u76f8\u4fe1\u6b63\u5f0f\u7684\u904b\u4f5c\u6a5f\u5236\u4e0b\uff0c\u5728\u7533\u8acb\u670d\u52d9\u7684\u521d\u671f\u5c31\u6703\u7d81\u5b9a\u597d\u5546\u5bb6\u4e3b\u6a5f\u56fa\u5b9aIP\u3002\u56e0\u6b64\u5373\u4f7f\u5176\u4ed6\u4eba\u4e82\u731c\u4e2d\u5546\u5e97\u7de8\u865f\uff0c\u7121\u6cd5\u5f9e\u6b63\u78ba\u7684IP\u4f4d\u7f6e\u767c\u9001\u8a0a\u606f\u662f\u6703\u88ab\u62d2\u7d55\u7684\u3002"]}),"\n",(0,i.jsx)(n.h3,{id:"\u8aaa\u4e86\u9019\u9ebc\u591a\u4f86\u5be6\u4f5c\u5427",children:"\u8aaa\u4e86\u9019\u9ebc\u591a\uff0c\u4f86\u5be6\u4f5c\u5427"}),"\n",(0,i.jsx)(n.p,{children:"Sign\u7684\u88fd\u4f5c\u6750\u6599\u6703\u9700\u8981\u4e09\u500b\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u8a0a\u606f\u5167\u6587"}),"\n",(0,i.jsx)(n.li,{children:"Nonce"}),"\n",(0,i.jsx)(n.li,{children:"Hash ID"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\u6700\u5f8c\u628a\u4e0a\u8ff0\u4e09\u500b\u9ecf\u8d77\u4f86\u5f8c\u518d\u505a\u4e00\u6b21",(0,i.jsx)(n.code,{children:"SHA256"})]}),"\n",(0,i.jsx)(n.h4,{id:"\u8a0a\u606f\u5167\u6587\u9700\u8981\u52a0\u5de5\u4e00\u4e0b",children:"\u300c\u8a0a\u606f\u5167\u6587\u300d\u9700\u8981\u52a0\u5de5\u4e00\u4e0b"}),"\n",(0,i.jsx)(n.p,{children:"\u9019\u500b\u8a0a\u606f\u5167\u6587\u4e0d\u662f\u76f4\u63a5\u628a\u6211\u5011\u6253\u7b97\u8981\u50b3\u7684JSON\u683c\u5f0f\u76f4\u63a5\u50b3\u51fa\u53bb\uff0c\u800c\u662f\u8981\u7b26\u5408\u4ee5\u4e0b\u898f\u683c\uff1a"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5148\u79fb\u9664\u6240\u6709\u7a7a\u503c\u7684\u53c3\u6578\uff0c\u53c3\u6578\u503c\u524d\u5f8c\u4e0d\u53ef\u6709\u7a7a\u767d\u3002"}),"\n",(0,i.jsx)(n.li,{children:"\u5c07\u5269\u9918\u6240\u6709\u53c3\u6578\u503c\u4f9d\u7167\u300c\u53c3\u6578\u540d\u7a31\u300d\u7531\u5c0f\u81f3\u5927\u6392\u5e8f (\u4e0d\u5206\u5927\u5c0f\u5beb\u5373 A < B and a < B )\uff0c\u7d44\u6210\u5982param1=value1&param2=value2 \u7684\u5b57\u4e32\u3002"}),"\n",(0,i.jsx)(n.li,{children:"\u5982\u70ba\u591a\u7bc0\u9ede\u53c3\u6578\u5247\u4e0d\u53c3\u8207 sign \u503c\u6f14\u7b97 \u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://ithelp.ithome.com.tw/upload/images/20210919/20130354dF1ZoqgKBU.png",alt:"https://ithelp.ithome.com.tw/upload/images/20210919/20130354dF1ZoqgKBU.png"})}),"\n",(0,i.jsx)(n.p,{children:"\u6240\u4ee5\u9019\u5f35\u898f\u683c\u66f8\u7684\u5167\u6587JSON\u7bc4\u4f8b\u7684\u9ec3\u8272\u90e8\u4efd\uff0c\u5c31\u662f\u4f9d\u64da\u4e0a\u9762\u898f\u5247\u5f8c\u9700\u8981\u653e\u5165\u7684\u5c6c\u6027\u8207\u503c\u3002\n\u6c92\u6a19\u9ec3\u8272\u7684\u70ba\u300c\u7a7a\u503c\u300d\u6216\u662f\u300c\u591a\u7bc0\u9ede\u53c3\u6578\u300d\uff0c\u6c92\u6709\u5165\u5834\u5238\uff0c\u56e0\u6b64\u4ed6\u5011\u5c31\u4e0d\u8981\u653e\u9032\u53bb\u4e86\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u6211\u5011\u4e00\u6a23\u5148\u4ee5\u958b\u767c\u898f\u683c\u66f8\u4e2d\u7684\u7bc4\u4f8b\u5167\u5bb9\u9032\u884c\u8655\u7406\uff0c\u5148\u78ba\u4fdd\u5beb\u51fa\u4f86\u7684Python\u7a0b\u5f0f\u53ef\u4ee5\u9054\u6210\u548c\u4ed6\u4e00\u6a23\u7684\u7d50\u679c\u3002\n\u9019\u88e1\u9762\u7684\u8655\u7406\u6709\u4e00\u4e9b\u5730\u65b9\u9700\u8981\u6162\u6162\u8655\u7406\u8207\u5617\u8a66\uff0c\u5149\u5b8c\u6210\u9019\u4e9b\u6b65\u9a5f\u5c31\u82b1\u4e86\u4e00\u9ede\u6642\u9593\uff0c\u5148\u770b\u4e00\u4e0b\u5b8c\u6574\u7684Python Code\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import urllib\n\nshop_data = {\n    \"ShopNo\": \"BA0026_001\", \"OrderNo\": \"A201804270001\", \"Amount\": 50000, \"CurrencyID\": \"TWD\", \"PayType\": \"A\",\n    \"ATMParam\": { \"ExpireDate\": \"20180502\" },\n    \"CardParam\": { },\n    \"ConvStoreParam\": { }, \"PrdtName\": \"\u865b\u64ec\u5e33\u865f\u8a02\u55ae\", \"ReturnURL\": \"http://10.11.22.113:8803/QPay.ApiClient/Store/Return\", \"BackendURL\": \"http://10.11.22.113:8803/QPay.ApiClient/AutoPush/PushSuccess\"\n}\n\nprint(\"* The original dictionary : {}\".format(shop_data))\n# Output: * The original dictionary : {'ShopNo': 'BA0026_001', 'OrderNo': 'A201804270001', 'Amount': 50000, 'CurrencyID': 'TWD', 'PayType': 'A', 'ATMParam': {'ExpireDate': '20180502'}, 'CardParam': {}, 'ConvStoreParam': {}, 'PrdtName': '\u865b\u64ec\u5e33\u865f\u8a02\u55ae', 'ReturnURL': 'http://10.11.22.113:8803/QPay.ApiClient/Store/Return', 'BackendURL': 'http://10.11.22.113:8803/QPay.ApiClient/AutoPush/PushSuccess'}\n\ndef check_passed_rule_param(value):\n    if value is None:\n        return False\n    elif type(value) is dict or type(value) is list:\n        return False\n    elif type(value) is str and not value.strip():\n        return False\n    else:\n        return True\n\nsorted_shop_datat = {key: shop_data.get(key) for key in sorted(shop_data.keys(), key=str.casefold)}\nprint(\"* sorted_shop_datat: {}\".format(sorted_shop_datat))\n# Output: * sorted_shop_datat: {'Amount': 50000, 'ATMParam': {'ExpireDate': '20180502'}, 'BackendURL': 'http://10.11.22.113:8803/QPay.ApiClient/AutoPush/PushSuccess', 'CardParam': {}, 'ConvStoreParam': {}, 'CurrencyID': 'TWD', 'OrderNo': 'A201804270001', 'PayType': 'A', 'PrdtName': '\u865b\u64ec\u5e33\u865f\u8a02\u55ae', 'ReturnURL': 'http://10.11.22.113:8803/QPay.ApiClient/Store/Return', 'ShopNo': 'BA0026_001'}\n\nremoved_rule_values_shop_data = {key: value for key, value in sorted_shop_datat.items() if check_passed_rule_param(value)}\nprint(\"* removed_rule_values_shop_data: {}\".format(removed_rule_values_shop_data))\n# Output: * removed_rule_values_shop_data: {'Amount': 50000, 'BackendURL': 'http://10.11.22.113:8803/QPay.ApiClient/AutoPush/PushSuccess', 'CurrencyID': 'TWD', 'OrderNo': 'A201804270001', 'PayType': 'A', 'PrdtName': '\u865b\u64ec\u5e33\u865f\u8a02\u55ae', 'ReturnURL': 'http://10.11.22.113:8803/QPay.ApiClient/Store/Return', 'ShopNo': 'BA0026_001'}\n\nurlparam = urllib.parse.urlencode(removed_rule_values_shop_data)\nprint(\"* urlparam: {}\".format(urlparam))\n# Output: * urlparam: Amount=50000&BackendURL=http%3A%2F%2F10.11.22.113%3A8803%2FQPay.ApiClient%2FAutoPush%2FPushSuccess&CurrencyID=TWD&OrderNo=A201804270001&PayType=A&PrdtName=%E8%99%9B%E6%93%AC%E5%B8%B3%E8%99%9F%E8%A8%82%E5%96%AE&ReturnURL=http%3A%2F%2F10.11.22.113%3A8803%2FQPay.ApiClient%2FStore%2FReturn&ShopNo=BA0026_001\n\nurlparam_no_percent_encode = urllib.parse.unquote(urlparam).replace(\"+\", \" \")\nprint(\"* urlparam_no_percent_encode: {}\".format(urlparam_no_percent_encode))\n# Output: * urlparam_no_percent_encode: Amount=50000&BackendURL=http://10.11.22.113:8803/QPay.ApiClient/AutoPush/PushSuccess&CurrencyID=TWD&OrderNo=A201804270001&PayType=A&PrdtName=\u865b\u64ec\u5e33\u865f\u8a02\u55ae&ReturnURL=http://10.11.22.113:8803/QPay.ApiClient/Store/Return&ShopNo=BA0026_001\n\n"})}),"\n",(0,i.jsx)(n.h5,{id:"\u7a0b\u5f0f\u8aaa\u660e",children:"\u7a0b\u5f0f\u8aaa\u660e"}),"\n",(0,i.jsx)(n.p,{children:"\u5e7e\u500b\u5730\u65b9\u9700\u8981\u8655\u7406\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u4e0d\u5206\u5927\u5c0f\u5beb\uff0c\u5c07JSON\u4e2d\u7684",(0,i.jsx)(n.code,{children:"\u5c6c\u6027(Key)"}),"\u7684\u90e8\u4efd\u4f5c\u6392\u5e8f(A->Z)"]}),"\n",(0,i.jsx)(n.li,{children:"\u50c5\u4fdd\u7559\u7b26\u5408\u898f\u5247\u7684\u5c6c\u6027"}),"\n",(0,i.jsx)(n.li,{children:"\u5c07JSON\u4e2d\u7684\u5c6c\u6027\u9375\u503c\u8f49\u6210\u985e\u4f3cURL\u7684\u53c3\u6578\u65b9\u5f0f\u76f8\u63a5\u5448\u73fe"}),"\n",(0,i.jsx)(n.li,{children:"\u4f7f\u7528URLEncode\u6a21\u7d44\u8f49\u51fa\u6703\u4ee5URI percent-encoding rules\u65b9\u5f0f\u5448\u73fe\u5c6c\u6027\u503c(\u6703\u52a0\u4e0a\u767e\u5206\u6bd4\u7b26\u865f\u958b\u982d)\uff0c\u8981\u518d\u8f49\u63db\u56deUTF-8\u7de8\u78bc(\u4e3b\u8981\u662f\u8b93\u4e2d\u6587\u6b63\u78ba\u986f\u793a)"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"1. \u5ffd\u7565\u5927\u5c0f\u5beb\u7684\u91cd\u65b0\u6392\u5e8f"}),"\n\u5c07\u539f\u9762JSON\u7684\u7269\u4ef6\u7684Key\u503c\u4f5csorted()\uff0c\u4ee5\u5b57\u4e32\u65b9\u5f0f\u6392\u5e8f\uff0c\u4f46\u8981\u52a0\u4e0a",(0,i.jsx)(n.code,{children:"str.casefold"}),"\u624d\u6703\u5ffd\u7565\u5927\u5c0f\u5beb\u7684ASCII\u503c\u3002\u5148\u53d6\u5f97\u6392\u5e8f\u904e\u5f8c\u7684Key List\u5f8c\uff0c\u518d\u4f7f\u7528Dictionary Comprehension\u65b9\u6cd5\u628a\u6392\u5e8f\u904e\u5f8c\u7684\u7269\u4ef6(\u4ee5Dictionary\u7d50\u69cb\u7d44\u6210)\u7522\u751f\u56de\u4f86\uff0c\u5982\u6b64\u4e00\u4f86\u6211\u5011\u5c31\u62ff\u5230\u4e86\u5c6c\u6027\u6392\u5e8f\u904e\u5f8c\u7684JSON\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"2. \u53bb\u6389\u4e0d\u8981\u7684\u5c6c\u6027"}),"\n\u6211\u5011\u5148\u6e96\u5099\u597d\u4e00\u500b\u898f\u5247\u904e\u6ffe\u7684\u5e03\u6797function\uff0c\u4e3b\u8981\u662f\u7528\u5728Dictionary Comprehension\u5f8c\u7684if\u689d\u4ef6\u5f0f\u3002\u610f\u601d\u5c31\u662f\u6211\u5011\u628a\u539f\u672c\u5df2\u6392\u5e8f\u597d\u7684\u65b0Dictionary\u91cd\u65b0\u8dd1\u4e00\u904d\uff0c\u53ea\u6703\u7559\u4e0b\u898f\u5247\u904e\u6ffe\u5668\u7d50\u679c\u70baTrue\u7684\u503c\u3002\u6240\u4ee5\u6211\u5011\u5c31\u6703\u62ff\u5230\u90a3\u4e9b\u6c92\u6709\u300c\u591a\u7bc0\u9ede\u300d\u6216\u300c\u7a7a\u503c\u300d\u7684\u5167\u6587\u7248\u672c\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"3. \u4f7f\u7528URLEncode\u6a21\u7d44\u5e6b\u5fd9\u8f49\u51fa"}),"\n\u900f\u904e\u597d\u7528\u7684urllib.parse.urlencode()\u5c31\u53ef\u4ee5\u5c07Dictionary\u8f49\u51fa\u6210URL\u7684\u53c3\u6578\u8868\u793a\u6cd5\u3002\u4f46\u9019\u88e1\u8f49\u51fa\u5f8c\u6703\u5c07\u975e\u82f1\u6578\u5b57\u7684\u7b26\u865f\u6216\u7de8\u78bc\u8f49\u6210\u4ee5\u767e\u5206\u6bd4\u958b\u982d\u7684URI percent-encoding rules\u7de8\u78bc\u6587\u5b57\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"4. \u628a\u6587\u5b57\u7de8\u78bc\u7684\u5448\u73fe\u518d\u6700\u5f8c\u8abf\u6574\u4e00\u4e0b"}),"\n\u6c38\u8c50\u6587\u4ef6\u4e2d\u662f\u6703\u5e0c\u671b\u4fdd\u7559\u539f\u59cb\u5e36\u6709\u985e\u4f3c\u4e2d\u6587\u7684\u5167\u6587\u53bb\u505a\u5f8c\u7e8c\u96dc\u6e4a\u904b\u7b97\uff0c\u56e0\u6b64\u6211\u5011\u9700\u8981\u518d\u52a0\u4e00\u9ede\u5de5\u3002\u900f\u904eurllib.parse.unquote()\u65b9\u6cd5\u5c07\u767e\u5206\u6bd4\u7de8\u78bc\u6cd5\u5247\u518d\u8f49\u56de\u539f\u672c\u7684\u7de8\u78bc\u3002\u53e6\u5916\u82e5\u539f\u672c\u53c3\u6578\u88e1\u9762(\u4e0d\u662f\u524d\u5f8c)\u6709\u7a7a\u767d\u7684\u8a71\uff0c\u8f49\u51fa\u4f86\u7684url\u53c3\u6578\u6703\u5c07\u7a7a\u767d\u8b8a\u6210",(0,i.jsx)(n.code,{children:"+"}),"\uff0c\u56e0\u6b64\u8981\u518d\u63db\u56de\u4f86\u4e00\u6b21\uff0c\u5426\u5247",(0,i.jsx)(n.code,{children:"Sign"}),"\u7684\u5167\u5bb9\u6703\u56e0\u6b64\u800c\u6709\u6240\u5dee\u7570\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u900f\u904e\u4e0a\u9762\u7684\u6b65\u9a5f\u8655\u7406\uff0c\u6211\u5011\u5c31\u80fd\u5920\u53d6\u5f97",(0,i.jsx)(n.code,{children:"\u8a0a\u606f\u5167\u6587"}),"\u7684\u90e8\u4efd\u3002"]}),"\n",(0,i.jsx)(n.h4,{id:"\u5f8c\u9762\u9084\u6709\u5169\u500b\u8ddf\u5c41\u87f2",children:"\u5f8c\u9762\u9084\u6709\u5169\u500b\u8ddf\u5c41\u87f2"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://ithelp.ithome.com.tw/upload/images/20210920/20130354raQrsODH8h.png",alt:"https://ithelp.ithome.com.tw/upload/images/20210920/20130354raQrsODH8h.png"})}),"\n",(0,i.jsxs)(n.p,{children:["\u4f46\u5728\u958b\u767c\u898f\u683c\u4e2d\uff0c\u628a\u4e0a\u9762\u6700\u7d42\u6211\u5011\u53d6\u5f97\u7684URLEncode\u9019\u4e32\u7d50\u679c\u7a31\u4e4b\u70ba\u300c\u5167\u6587",(0,i.jsx)(n.strong,{children:"\u96dc\u6e4a"}),"\u300d\uff0c\u6211\u500b\u4eba\u8a8d\u70ba\u9019\u500b\u6b65\u9a5f\u4f7f\u7528",(0,i.jsx)(n.strong,{children:"\u96dc\u6e4a"}),"\u9019\u500b\u8a5e\u5f59\u4f3c\u4e4e\u662f\u4e0d\u592a\u6b63\u78ba\u3002\u9019\u88e1\u6c92\u6709\u7528\u5230\u4efb\u4f55\u96dc\u6e4a\u7684\u6280\u8853\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u63a5\u4e0b\u4f86\u9084\u8981\u518d\u505a\u5169\u500b\u76f8\u7576\u7c21\u55ae\u7684\u52d5\u4f5c\uff0c\u5c07\u662f\u5c07Nonce\u548cHash ID\u62fc\u5728\u4e0a\u9762\u9019\u4e00\u4e32\u7684\u5f8c\u9762\uff0c\u4f46\u6587\u4ef6\u4e2d\u628a\u9019\u4e09\u500b\u62fc\u63a5\u5728\u4e00\u8d77\u7684\u7522\u51fa\u7d50\u679c\u7a31\u4e4b\u70ba\u300c\u5b57\u4e32",(0,i.jsx)(n.strong,{children:"\u96dc\u6e4a"}),"\u300d\uff0c\u6211\u4e00\u6a23\u662f\u89ba\u5f97\u9019\u500b\u52d5\u4f5c\u4e5f\u6c92\u6709\u96dc\u6e4a\u5728\u88e1\u9762\u3002",(0,i.jsx)(n.del,{children:"(\u96e3\u9053\u662f\u96dc\u4e82\u7684\u6e4a\u5728\u4e00\u8d77\uff01\uff1f)"})]}),"\n",(0,i.jsx)(n.p,{children:"\u7e3d\u4e4b\uff0c\u628a\u9019\u4e09\u500b\u518d\u62fc\u63a5\u8d77\u4f86\u5f8c\uff0c\u5c31\u53ef\u4ee5\u9032\u884c\u6700\u7d42\u7684SHA256\u8655\u7406\uff0c\u96e2\u6210\u529f\u5c31\u5728\u4e0d\u9060\u8655\uff01"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import hashlib\n\nnonce = "NjM2NjA0MzI4ODIyODguMzo3NzI0ZDg4ZmI5Nzc2YzQ1MTNhYzg2MTk3NDBlYTRhNGU0N2IxM2Q2M2JkMTIwOGU5YzZhMGFmNGY5MjA5YzVm"\nhash_id = "17D8E6558DC60E702A6B57E1B9B7060D"\n\nfinal_shop_data = "{}{}{}".format(urlparam_no_percent_encode, nonce, hash_id)\nprint(final_shop_data)\n# Output: Amount=50000&BackendURL=http://10.11.22.113:8803/QPay.ApiClient/AutoPush/PushSuccess&CurrencyID=TWD&OrderNo=A201804270001&PayType=A&PrdtName=\u865b\u64ec\u5e33\u865f\u8a02\u55ae&ReturnURL=http://10.11.22.113:8803/QPay.ApiClient/Store/Return&ShopNo=BA0026_001NjM2NjA0MzI4ODIyODguMzo3NzI0ZDg4ZmI5Nzc2YzQ1MTNhYzg2MTk3NDBlYTRhNGU0N2IxM2Q2M2JkMTIwOGU5YzZhMGFmNGY5MjA5YzVm17D8E6558DC60E702A6B57E1B9B7060D\n\nsign = hashlib.sha256(final_shop_data.encode(\'UTF-8\')).hexdigest().upper()\nprint(sign)\n# Output: A3EAEE3B361B7E7E9B0F6422B954ECA5D54CEC6EAB0880CB484AA6FDA4154331\n'})}),"\n",(0,i.jsx)(n.h5,{id:"\u7a0b\u5f0f\u8aaa\u660e-1",children:"\u7a0b\u5f0f\u8aaa\u660e"}),"\n",(0,i.jsxs)(n.p,{children:["\u9019\u908a\u8981\u8655\u7406\u7684\u4e8b\u60c5\u5176\u5be6\u883b\u7c21\u55ae\u7684\uff0c\u628a\u8a31\u4e45\u4e0d\u898b\u7684",(0,i.jsx)(n.code,{children:"Nonce"}),"\u548c",(0,i.jsx)(n.code,{children:"Hash ID"}),"\u518d\u8acb\u51fa\u4f86\uff0c\u7136\u5f8c\u5b57\u4e32\u9ecf\u4e00\u9ecf\u4e4b\u5f8c\uff0c\u7528\u6211\u5011\u5148\u524d\u505a\u904e\u8981\u7522\u751fHash ID\u6642\u7684SHA256\u4e00\u6a23\uff0c\u4f9d\u6a23\u756b\u846b\u8606\uff0c\u5c31\u53ef\u4ee5\u7522\u751f\u51fa\u6700\u5f8c\u7684\u5927\u9b54\u738b",(0,i.jsx)(n.code,{children:"Sign"}),"\u4e86\uff01"]}),"\n",(0,i.jsx)(n.h3,{id:"\u7d42\u65bc\u628aapi\u524d\u7f6e\u6240\u9700\u6e96\u5099\u597d\u4e86",children:"\u7d42\u65bc\u628aAPI\u524d\u7f6e\u6240\u9700\u6e96\u5099\u597d\u4e86"}),"\n",(0,i.jsxs)(n.p,{children:["\u70ba\u4e86\u8981\u5b8c\u6210\u4e4b\u5f8c\u7684\u6bcf\u4e00\u6b21API\u53eb\u7528\uff0c\u6211\u5011\u4e00\u6b65\u4e00\u6b65\u628a\u6240\u9700\u8981\u7684\u5c6c\u6027\u90fd\u4e00\u500b\u4e00\u500b\u9a57\u8b49\u4e14\u5be6\u4f5c\u51fa\u4f86\u4e86\uff0c\u6700\u56f0\u96e3\u7684\u7576\u7136\u5c31\u662f",(0,i.jsx)(n.code,{children:"Message"}),"\u548c",(0,i.jsx)(n.code,{children:"Sign"}),"\uff0c\u63a5\u4e0b\u4f86\u6211\u5011\u5c31\u53ef\u4ee5\u4f7f\u7528\u6211\u5011\u81ea\u5df1\u7522\u751f\u7684\u8cc7\u6599\uff0c\u4f86\u6b63\u5f0f\u5c0d\u6c38\u8c50API\u4f5c\u547c\u53eb\u56c9\uff01"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>l});var s=r(6540);const i={},t=s.createContext(i);function a(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);