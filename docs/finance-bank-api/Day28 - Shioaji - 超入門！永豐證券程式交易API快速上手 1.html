<!doctype html>
<html lang="zh-TW" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-finance-bank-api/Day28 - Shioaji - 超入門！永豐證券程式交易API快速上手 1">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Day28 - Shioaji - 超入門！永豐證券程式交易API快速上手 1 | Code Tenshu 程式技術天守閣</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://rexmenlin.github.io/docs/finance-bank-api/Day28 - Shioaji - 超入門！永豐證券程式交易API快速上手 1"><meta data-rh="true" name="docusaurus_locale" content="zh-TW"><meta data-rh="true" name="docsearch:language" content="zh-TW"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Day28 - Shioaji - 超入門！永豐證券程式交易API快速上手 1 | Code Tenshu 程式技術天守閣"><meta data-rh="true" name="description" content="一晃眼，鐵人賽就進入了尾聲，先前一直說有時間要來寫Shioaji的，總是不能食言。我想就用最後兩篇的篇幅快速的導讀一下Shioaji的基礎入門功能。我發現自己之前每篇單日文章都希望寫的豐富一點，因此每天下班後幾乎都把時間貢獻在鐵人寫測試、研究與撰文上面，真的是有一點吃不消。而現在希望自己兩個主題都有參與到，貪心的結果就是每天弄的壓力很大，搞的下班比上班時還累。不過終究還是咬牙撐過來了。"><meta data-rh="true" property="og:description" content="一晃眼，鐵人賽就進入了尾聲，先前一直說有時間要來寫Shioaji的，總是不能食言。我想就用最後兩篇的篇幅快速的導讀一下Shioaji的基礎入門功能。我發現自己之前每篇單日文章都希望寫的豐富一點，因此每天下班後幾乎都把時間貢獻在鐵人寫測試、研究與撰文上面，真的是有一點吃不消。而現在希望自己兩個主題都有參與到，貪心的結果就是每天弄的壓力很大，搞的下班比上班時還累。不過終究還是咬牙撐過來了。"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://rexmenlin.github.io/docs/finance-bank-api/Day28 - Shioaji - 超入門！永豐證券程式交易API快速上手 1"><link data-rh="true" rel="alternate" href="https://rexmenlin.github.io/docs/finance-bank-api/Day28 - Shioaji - 超入門！永豐證券程式交易API快速上手 1" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://rexmenlin.github.io/docs/finance-bank-api/Day28 - Shioaji - 超入門！永豐證券程式交易API快速上手 1" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Code Tenshu 程式技術天守閣 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Code Tenshu 程式技術天守閣 Atom Feed"><link rel="stylesheet" href="/assets/css/styles.cd44ce8e.css">
<link rel="preload" href="/assets/js/runtime~main.198d87d1.js" as="script">
<link rel="preload" href="/assets/js/main.3f91edfd.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳至主要内容"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">跳至主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/codetenshu_logo_blackwhite.png" alt="程式技術天守閣Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/codetenshu_logo_blackwhite.png" alt="程式技術天守閣Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">程式技術天守閣</b></a><a class="navbar__item navbar__link" href="/blog">Blog文章</a><a class="navbar__item navbar__link" href="/blog/tags">分類Tags</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">系列文章</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切換淺色/暗黑模式（當前為淺色模式）" aria-label="切換淺色/暗黑模式（當前為淺色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到頂部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">系列文章說明</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/金融api串接">金融API串接</a><button aria-label="打開/收起側邊欄選單「金融API串接」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/前言 - iThome鐵人賽佳作系列作">前言 - iThome鐵人賽佳作系列作</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day01 - 一切從試著了解開始">Day01 - 一切從試著了解開始</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day02 - 盤點需求，準備環境與工具">Day02 - 盤點需求，準備環境與工具</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day03 - 分析技術文件後，開始做個Nonce開胃菜吧">Day03 - 分析技術文件後，開始做個Nonce開胃菜吧</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day04 - 金流API的起手式，每次溝通都機密">Day04 - 金流API的起手式，每次溝通都機密</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day05 - 繼續把加密這件事看下去">Day05 - 繼續把加密這件事看下去</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day06 - 安全簽章簽下去，API呼叫沒在怕">Day06 - 安全簽章簽下去，API呼叫沒在怕</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day07 - 淺談binary與十六進位Hex、UTF-8文字編碼轉換">Day07 - 淺談binary與十六進位Hex、UTF-8文字編碼轉換</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day08 - 十六進位格式的後續探討，字串傳輸容量倍增了">Day08 - 十六進位格式的後續探討，字串傳輸容量倍增了</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day09 - 安全無虞後，開始建立訂單 ATM虛擬帳號篇1">Day09 - 安全無虞後，開始建立訂單 ATM虛擬帳號篇1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day10 - 安全無虞後，開始建立訂單 ATM虛擬帳號篇2">Day10 - 安全無虞後，開始建立訂單 ATM虛擬帳號篇2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day11 - 禮尚往來，我們也需要解開API回傳的密秘">Day11 - 禮尚往來，我們也需要解開API回傳的密秘</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day12 - 為BackendURL中收到PayToken鋪路，Django來了。">Day12 - 為BackendURL中收到PayToken鋪路，Django來了。</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day13 - 將Django程式，放上Heroku！">Day13 - 將Django程式，放上Heroku！</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day14 - 使用Heroku Postgres資料庫，存儲訂單交易資訊">Day14 - 使用Heroku Postgres資料庫，存儲訂單交易資訊</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day15 - 撰寫Django的Model，使用ORM和Heroku Postgres綁一起。">Day15 - 撰寫Django的Model，使用ORM和Heroku Postgres綁一起。</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day16 - 取得PayToken的最後一哩路很慢長">Day16 - 取得PayToken的最後一哩路很慢長</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day17 - 永豐API虛擬帳戶付款與PayToken查詢與更新狀態">Day17 - 永豐API虛擬帳戶付款與PayToken查詢與更新狀態</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day18 - 提供信用卡付款以及取得PayToken流程">Day18 - 提供信用卡付款以及取得PayToken流程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day19 - 防止掉單小幫手，以時間條件查詢交易訂單">Day19 - 防止掉單小幫手，以時間條件查詢交易訂單</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day20 - 以Django Web框架實作永豐API線上支付模擬情境1">Day20 - 以Django Web框架實作永豐API線上支付模擬情境1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day21 - 以Django Web框架實作永豐API線上支付模擬情境2 - 購物車與付款方式確認頁">Day21 - 以Django Web框架實作永豐API線上支付模擬情境2 - 購物車與付款方式確認頁</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day22 - 以Django Web框架實作永豐API線上支付模擬情境3 - 兩種付款方式實作">Day22 - 以Django Web框架實作永豐API線上支付模擬情境3 - 兩種付款方式實作</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day23 - 以Django Web框架實作永豐API線上支付模擬情境4 - 信用卡刷卡結果">Day23 - 以Django Web框架實作永豐API線上支付模擬情境4 - 信用卡刷卡結果</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day24 - 以Django Web框架實作永豐API線上支付模擬情境5 - 我的訂單">Day24 - 以Django Web框架實作永豐API線上支付模擬情境5 - 我的訂單</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day25 - 永豐線上收款支付API功能實作總結1">Day25 - 永豐線上收款支付API功能實作總結1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day26 - 永豐線上收款支付API功能實作總結2">Day26 - 永豐線上收款支付API功能實作總結2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day27 - 永豐線上收款支付API功能實作總結3 - 如何讓機敏性設定值更有保護力">Day27 - 永豐線上收款支付API功能實作總結3 - 如何讓機敏性設定值更有保護力</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/finance-bank-api/Day28 - Shioaji - 超入門！永豐證券程式交易API快速上手 1">Day28 - Shioaji - 超入門！永豐證券程式交易API快速上手 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day29 - Shioaji - 超入門！永豐證券程式交易API快速上手 2">Day29 - Shioaji - 超入門！永豐證券程式交易API快速上手 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/finance-bank-api/Day30 - 鐵人賽永豐APIs實戰30天，跪著都要完賽。">Day30 - 鐵人賽永豐APIs實戰30天，跪著都要完賽。</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="頁面路徑"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主頁面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/金融api串接"><span itemprop="name">金融API串接</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Day28 - Shioaji - 超入門！永豐證券程式交易API快速上手 1</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本頁導覽</button></div><div class="theme-doc-markdown markdown"><header><h1>Day28 - Shioaji - 超入門！永豐證券程式交易API快速上手 1</h1></header><p>一晃眼，鐵人賽就進入了尾聲，先前一直說有時間要來寫Shioaji的，總是不能食言。我想就用最後兩篇的篇幅快速的導讀一下Shioaji的基礎入門功能。我發現自己之前每篇單日文章都希望寫的豐富一點，因此每天下班後幾乎都把時間貢獻在鐵人寫測試、研究與撰文上面，真的是有一點吃不消。而現在希望自己兩個主題都有參與到，貪心的結果就是每天弄的壓力很大，搞的下班比上班時還累。不過終究還是咬牙撐過來了。</p><p>這兩天剛好連假+特休假，所以在收尾豐收款線上支付API - <strong>豐收款</strong> 的專題系列文時，也邊準備打算用最後幾篇來把Shioaji作個旋風式介紹。就當作是我的鐵人賽的番外篇吧，能寫多少算多少，除了希望有機會幫助到別人，自己也一直想研究這個主題。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="什麼是shioaji">什麼是Shioaji<a class="hash-link" href="#什麼是shioaji" title="標題的直接連結">​</a></h3><p>Shioaji在我Day1的文章就有介紹過，就不再贅述，總之你對於<strong>股票、期貨、選擇權</strong>等的交易，除了使用人為方式透過App也好網站也好的方式下單外，永豐提供了一個給程式使用的API，名為Shioaji，讓<strong>會寫程式的你</strong>可以進行更多靈活的運用，自己有獨到的交易策略，以及想要嚴守自己的交易紀律與規則的人，可以透過這個方式幫你圓夢。
(然後邁向財務自由..... 嗯！！癌大主委在講都沒在聽，沒有什麼財務自由這種事！)</p><p>由於永豐官網以及活動頁面有提供了幾個教學，建議大家都乖乖的先去把課程上完一輪，會比我在這裡寫清楚的多。
不確定這個<a href="https://ithelp.ithome.com.tw/2021ironman/rules" target="_blank" rel="noopener noreferrer">活動頁面</a>會不會一直都在，還是先幫大家把網址整理出來：
永豐官方Shioaji API內部專業講師教學：<a href="https://www.youtube.com/playlist?list=PL_KnG63-iRTTIZpEdApKO908z0lW3_OiW" target="_blank" rel="noopener noreferrer">Youtube播放清單</a></p><p>播放清單如下，不過裡面的順序沒有編的很正確，上面1~6可以先看。然後下面的7~10還有另4篇，請照影片檔名的順序讀。
<img loading="lazy" src="https://ithelp.ithome.com.tw/upload/images/20211012/20130354t7GQSQMYB6.png" alt="https://ithelp.ithome.com.tw/upload/images/20211012/20130354t7GQSQMYB6.png" class="img_ev3q"></p><p>其中有一篇，是針對股票交易談到比較細的 交易搓合制度等，和程式技術無關，但對於細節運作釐清相當重要。
可以多看個兩次：<strong>2.逐筆搓合制度、API新增功能及β風控機器人介紹</strong></p><p>其他的部份就都和程式比較有關，但必須說一下：</p><ol><li>講師解釋很清楚，但顧及學員可能有些剛接觸程式技術，因此談的深度不深 → 不要期待看完影片你就會懂整套API怎麼使用</li><li>因為是先前永豐有開實體課程直接錄制，聲音有一點小，而且拍攝後畫面看不太清楚
但可以快速作為一個入門，以及理解API是什麼。</li></ol><p>講師在影片中，有一個網址，幫大家列在下面，講師一再強調<strong>Basic Overview</strong>一定要看！
<a href="https://sinotrade.github.io/slides/" target="_blank" rel="noopener noreferrer">https://sinotrade.github.io/slides/</a></p><p><img loading="lazy" src="https://ithelp.ithome.com.tw/upload/images/20211012/20130354HEaZeqD8vy.png" alt="https://ithelp.ithome.com.tw/upload/images/20211012/20130354HEaZeqD8vy.png" class="img_ev3q"></p><p>而正式的Shioaji官網文件在這裡：<a href="https://sinotrade.github.io/" target="_blank" rel="noopener noreferrer">https://sinotrade.github.io/</a>
若真的想要透過Shioaji作程式交易的讀者，必需詳讀與實際跟著操作。</p><p>然後，很不幸的，因為國際化是我們未來雙語國家的目標(咦?)，上面的文件都是英文的，學Shioaji也可以順便練英文，一舉雙得呀！相信難不倒大家。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="來吧先架設環境">來吧！先架設環境<a class="hash-link" href="#來吧先架設環境" title="標題的直接連結">​</a></h3><p>在其實最早開賽前，我就已經先研究一下Shioaji，當時是使用Anaconda配合JupyterNotebook的環境，有先測試過一些程式運作。不過因為先前的豐收款，寫了庫米狗屋KummyShop的情境案例，使用了PyCharm Community環境 (搭配Django Web框架)，想說為了一致性，也在PyCharm上面來寫Shioaji的測試驗證案例吧。</p><p>但萬萬沒想到，一開始就卡住了，花了我好久的時間，一直出現DLL無法正確載入的問題，等一下我會說明，怎麼解決。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="開設一個新專案安裝shioaji套件">開設一個新專案，安裝Shioaji套件<a class="hash-link" href="#開設一個新專案安裝shioaji套件" title="標題的直接連結">​</a></h4><p>在PyCharm中，先開設一個Python新專案。一開始我們通常都會使用PyCharm的venv建一個新的環境，開完專案後，依照永豐金的說明，我們使用Terminal來進行pip安裝</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; pip install shioaji</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>安裝是成功了沒錯，目前我安裝的版本是：<code>shioaji-0.3.3.dev4</code></p><p>於是，很開心的把先前在Jupyter Notebook測試的code趕緊開一個test.py檔案來測試，怎麼樣都是過不了。</p><p>code不用多，光第一行就錯誤了。</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> shioaji </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> sj</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="https://ithelp.ithome.com.tw/upload/images/20211012/20130354EXBjVyYu5r.png" alt="https://ithelp.ithome.com.tw/upload/images/20211012/20130354EXBjVyYu5r.png" class="img_ev3q"></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ImportError: DLL load failed while importing solclient: 動態連結程式庫 (DLL) 初始化例行程序失敗。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="怎麼解決dll初始化問題呢">怎麼解決DLL初始化問題呢？<a class="hash-link" href="#怎麼解決dll初始化問題呢" title="標題的直接連結">​</a></h4><p>後來查了Shioaji相關的討論區，後來有人提到Shioaji目前支援的Python環境，若在Windows中建議使用Anaconda。如果非Anaconda的虛擬環境會有一些不相容的異常，對，我就遇到了。</p><p>所以解決方法是，使用PyCharm時，還是將Python Interpreter由原先的venv環境改成Anaconda的虛擬環境。</p><p><img loading="lazy" src="https://ithelp.ithome.com.tw/upload/images/20211012/20130354zFkz4Te5vk.png" alt="https://ithelp.ithome.com.tw/upload/images/20211012/20130354zFkz4Te5vk.png" class="img_ev3q"></p><p>改為：
<img loading="lazy" src="https://ithelp.ithome.com.tw/upload/images/20211012/20130354P7j6LNKxBJ.png" alt="https://ithelp.ithome.com.tw/upload/images/20211012/20130354P7j6LNKxBJ.png" class="img_ev3q">
註：上面是Python 3.7或3.8並不是造成錯誤的原因，Shioaji目前撰文時是支援3.6~3.8。</p><p>改完後，要記得在Anaconda虛擬環境中確認是否有安裝Shioaji，若沒有，要再使用pip安裝一次。</p><p>再執行一次，原先的DLL初始化錯誤就消失了。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="開始來嘗試第一支最簡單的範例">開始來嘗試第一支最簡單的範例<a class="hash-link" href="#開始來嘗試第一支最簡單的範例" title="標題的直接連結">​</a></h3><p>如果你本身有永豐證券帳戶，也申請了API使用憑證，那你可以嘗試使用自己的帳號與密碼(當然要小心使用，責任需自負)。若沒有，你可以使用永豐提供的測試帳號，但無論是哪一種，在資源有限的情況下，在使用上都有連線上限以及與些資料取用的限制，詳情請看<a href="https://sinotrade.github.io/tutor/limit/" target="_blank" rel="noopener noreferrer">這裡</a>。因此，請於程式login後，記得養成logout的好習慣。</p><ul><li>測試帳號：PAPIUSER01 ~ PAPIUSER08</li><li>測試密碼：2222</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="step1-登入login">STEP1: 登入(Login)<a class="hash-link" href="#step1-登入login" title="標題的直接連結">​</a></h4><p>使用Shioaji的第一個步驟，除了import Shioaji的套件外，就要先確認整個程式交易的使用者是誰，這和你使用App要進行下單是一樣的。</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> shioaji </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> sj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">api </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Shioaji</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">login</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    person_id</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;YOUR_ID&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    passwd</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;YOUR_PASSWORD&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    contracts_cb</span><span class="token operator" style="color:#393A34">=</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> security_type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">repr</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">security_type</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> fetch done.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果，你使用的是測試帳號進行模擬(Simulation)用途，請在Shioaji()裡加上參數<code>simulation=True</code></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> shioaji </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> sj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">api </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Shioaji</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">simulation</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">person_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;PAPIUSER05&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">passwd </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;2222&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">login</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">person_id</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">person_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> passwd</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">passwd</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="step2-確認accounts">STEP2: 確認Accounts<a class="hash-link" href="#step2-確認accounts" title="標題的直接連結">​</a></h4><p>而這裡的login指的是對於永豐而言的證券用戶的登入資訊，而一個永豐的用戶底下會開設不同的證券、期貨等的交易帳戶。因此一個用戶底下的股票、期貨等，是分開且不同的交易帳戶。</p><p>因此在登入後，可使用list_accounts()方法取回此用戶底下的各種帳戶：</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">accounts </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">list_accounts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">accounts</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: [FutureAccount(person_id=&#x27;PAPIUSER05&#x27;, broker_id=&#x27;F002000&#x27;, account_id=&#x27;9101663&#x27;, signed=True, username=&#x27;PAPIUSER05&#x27;), StockAccount(person_id=&#x27;PAPIUSER05&#x27;, broker_id=&#x27;9A95&#x27;, account_id=&#x27;0506206&#x27;, signed=True, username=&#x27;PAPIUSER05&#x27;)]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>以上資訊可看到這個用戶底下有：</p><ul><li>一個期貨(Future)帳戶：account_id=&#x27;9101663&#x27;</li><li>一個股票(Stock)帳戶：account_id=&#x27;0506206&#x27;</li></ul><p>但一個用戶是可擁有超過一個以上的證券戶，可以列出預設Future或Stock的帳戶：</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Default Stock Account: {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stock_account</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Default Future Account: {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">futopt_account</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: Default Stock Account: person_id=&#x27;PAPIUSER05&#x27; broker_id=&#x27;9A95&#x27; account_id=&#x27;0506206&#x27; signed=True username=&#x27;PAPIUSER05&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: Default Future Account: person_id=&#x27;PAPIUSER05&#x27; broker_id=&#x27;F002000&#x27; account_id=&#x27;9101663&#x27; signed=True username=&#x27;PAPIUSER05&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>其中重要的是signed是指是否已簽署證券或期貨的<a href="https://www.sinotrade.com.tw/ec/20191125/Main/index.aspx#pag4" target="_blank" rel="noopener noreferrer">API簽署書</a>。</p><p>若你有多個帳戶，可以透過下面的指令修改預設帳戶：</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_default_account</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">accounts</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stock_account</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_default_account</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">accounts</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">futopt_account</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="step3-重要的交易憑證ca">STEP3: 重要的交易憑證CA<a class="hash-link" href="#step3-重要的交易憑證ca" title="標題的直接連結">​</a></h4><p>有關下單的憑證，請參考<a href="https://www.sinotrade.com.tw/CSCenter/CSCenter_13_1?tab=2" target="_blank" rel="noopener noreferrer">永豐官網</a>以及相關憑證軟體工具下載</p><p>基本上，你若成功於Windows電腦下載憑證後，會放置在<code>C:\ekey\</code>底下的目錄，中間會有一些路徑以及身份證字號等目錄就由各位自行確認。檔名會是<code>Sinopac.pfx</code></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">activate_ca</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ca_path</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">r&#x27;C:\ekey\xxx\xxxxxxxxxx\x\Sinopac.pfx&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ca_passwd</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;YOUR_PASSWORD&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    person_id</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;YOUR_PERSON_ID&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="step4-查詢前先立contracts">STEP4: 查詢前先立Contracts<a class="hash-link" href="#step4-查詢前先立contracts" title="標題的直接連結">​</a></h4><p>我們的程式想要取得標的的金融資訊，會先需要指定相關的Contract(契約)。透過Shioaji instance物件下Contracts底下又能區分出Stocks以及Futures。</p><p>我指若直接將Contracts列出來，如下：</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Contracts</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: Indexs=(OTC, TSE) Stocks=(OES, OTC, TSE) Futures=(BRF, BTF, CAF, CBF, CCF, CDF, CE1, CEF, CFF, CGF, CHF, CJ1, CJF, CKF, CLF, CM1, CMF, CNF, CQF, CRF, CSF, CUF, CWF, CYF, CZF, DC1, DCF, DD1, DDF, DEF, DFF, DGF, DHF, DIF, DJF, DKF, DLF, DN1, DNF, DOF, DP1, DPF, DQF, DSF, DVF, DW1, DWF, DXF, DYF, DZ1, DZF, E4F, EEF, EGF, EHF, EMF, EP1, EPF, ERF, EXF, EYF, EZF, F1F, FBF, FE1, FEF, FF1, FFF, FGF, FKF, FNF, FQF, FRF, FTF, FVF, FWF, FXF, FYF, FZF, G2F, GAF, GCF, GDF, GHF, GIF, GJF, GLF, GMF, GNF, GOF, GRF, GTF, GUF, GWF, GXF, GZF, HAF, HBF, HCF, HHF, HI1, HIF, HLF, HOF, HSF, HYF, IA1, IAF, IHF, IIF, IJF, IMF, IOF, IPF, IQF, IRF, ITF, IXF, IYF, IZF, JBF, JF1, JFF, JMF, JNF, JPF, JSF, JWF, JZF, KAF, KBF, KCF, KDF, KEF, KFF, KGF, KIF, KKF, KLF, KOF, KP1, KPF, KSF, KUF, KWF, LBF, LCF, LEF, LIF, LMF, LO1, LOF, LQF, LRF, LTF, LUF, LV1, LVF, LWF, LXF, LYF, MAF, MBF, MJF, MK1, MKF, MPF, MQF, MVF, MX2, MXF, MYF, NAF, NBF, NCF, NDF, NEF, NGF, NI1, NIF, NJF, NLF, NMF, NOF, NQF, NSF, NUF, NVF, NWF, NXF, NYF, NZF, OAF, OBF, OCF, ODF, OEF, OHF, OJF, OKF, OLF, OMF, OOF, OPF, OQF, ORF, OSF, OTF, OUF, OVF, OWF, OXF, OYF, OZF, PAF, PBF, PCF, PDF, PEF, PFF, PGF, PHF, PIF, PJF, PKF, PL1, PLF, PMF, PNF, POF, PPF, PQF, PRF, PSF, PTF, PUF, PVF, PWF, PXF, PYF, PZF, QAF, QBF, QCF, QDF, QEF, QFF, QGF, QHF, QIF, QJF, QKF, QLF, QM1, QMF, QNF, QOF, QPF, QQF, QRF, QSF, RHF, RTF, SPF, T5F, TGF, TJF, TXF, UDF, UNF, XAF, XBF, XEF, XIF, XJF, ZEF) Options=(CAO, CBO, CCO, CDA, CDO, CEA, CEO, CFO, CGO, CHO, CJO, CKO, CLO, CMO, CNO, CQO, CRO, CSO, CZO, DCO, DEO, DFO, DGO, DHO, DJO, DKO, DLO, DNO, DOO, DPO, DQO, DSO, DVO, DWO, DXO, GIO, GXO, HCO, IJO, LOO, NYO, NZO, OAO, OBO, OCO, OJO, OKO, OOO, OZO, QBO, RHO, RTO, TEO, TFO, TGO, TX2, TXO)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>從輸出結果可看出有三種Contracts：</p><ul><li>Indexes</li><li>Stocks</li><li>Futures</li></ul><p><strong>Indexes</strong>指的是大盤的指數，<code>TSE</code>是有關上市大型股的<strong>台灣加權指數</strong>，而<code>OTC</code>則為有關中小型股的<strong>櫃買指數</strong>。
而<strong>Stocks</strong>指的就是股票，<code>TSE</code>指的就是在證交所<strong>上市</strong>的股票，而<code>OTC</code>是在櫃買市場<strong>上櫃</strong>的股票，而<code>OES</code>，老實說我不確定是不是<strong>興櫃市場</strong>(通常一般興櫃會是<code>ROTC</code>)，這個如果有了解的朋友再麻煩指正。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="找檔股票或期貨的基本資訊來看看">找檔股票或期貨的基本資訊來看看<a class="hash-link" href="#找檔股票或期貨的基本資訊來看看" title="標題的直接連結">​</a></h4><p><strong>Stocks</strong>
我們就找一檔和永豐有關的ETF股票(寫永豐專題找元X的0050像話嗎！ 其實也不是不行啦 哈)，<strong>永豐臺灣加權</strong>的股票代號為<code>006204</code>，所以要取得這檔股票的Contract就是用以下的取得方法：
<code>api.Contracts.Stocks.TSE.TSE006204</code></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">stk_006204 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Contracts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Stocks</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TSE</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TSE006204</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">stk_006204</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: exchange=&lt;Exchange.TSE: &#x27;TSE&#x27;&gt; code=&#x27;006204&#x27; symbol=&#x27;TSE006204&#x27; name=&#x27;永豐臺灣加權&#x27; category=&#x27;00&#x27; unit=1000 limit_up=97.65 limit_down=79.95 reference=88.8 update_date=&#x27;2021/10/12&#x27; margin_trading_balance=22893 day_trade=&lt;DayTrade.Yes: &#x27;Yes&#x27;&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>其中的參考價<code>reference</code>為前一日收盤價，以此例為88.8元。</p><p>文件中說明的各屬性，請自行參考</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">exchange (Exchange): Attributes of industry.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {OES, OTC, TSE ...etc}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">code (str): Id.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">symbol (str): Symbol.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name (str): Name.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">category (str): Category.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">limit_up (float): Limit up.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">limit_down (float): Limit down.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">reference (float): Reference price.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">update_date (str): Update date.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">margin_trading_balance (int): Margin trading balance.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">short_selling_balance (int): Short selling balance.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">day_trade (DayTrade): Day trade.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {Yes, No, OnlyBuy}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Futures</strong>
接著，我們來看看期貨資訊。</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;TXF: {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Contracts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Futures</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TXF</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#Output: TXF: TXF(TXF202203, TXF202206, TXF202209, TXF202111, TXF202112, TXF202110, TXFR1, TXFR2)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>若我們將期貨的Contracts底下的<code>TXF</code> (<strong>大台指</strong>) 列出來，看有哪些Contract可操作。
以目前撰文時間為2021年10月中來看，會看到<strong>遠月期貨</strong>：TXF202203、TXF202206、TXF202209
以及<strong>近三個月期貨</strong>：TXF202110、TXF202111、TXF202112
還有所價的<strong>近一、近二</strong>：TXFR1、TXFR2</p><p>我們可以列出觀察一下內容：</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;台指期近一: {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Contracts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Futures</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TXF</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TXFR1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;台指期近二: {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Contracts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Futures</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TXF</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TXFR2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;台指期202112: {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Contracts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Futures</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TXF</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TXF202112</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;台指期202206: {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Contracts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Futures</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TXF</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TXF202206</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: 台指期近一: code=&#x27;TXFR1&#x27; symbol=&#x27;TXFR1&#x27; name=&#x27;臺股期貨近月&#x27; category=&#x27;TXF&#x27; delivery_month=&#x27;202110&#x27; delivery_date=&#x27;2021/10/20&#x27; underlying_kind=&#x27;I&#x27; unit=1 limit_up=18287.0 limit_down=14963.0 reference=16625.0 update_date=&#x27;2021/10/12&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: 台指期近二: code=&#x27;TXFR2&#x27; symbol=&#x27;TXFR2&#x27; name=&#x27;臺股期貨次月&#x27; category=&#x27;TXF&#x27; delivery_month=&#x27;202111&#x27; delivery_date=&#x27;2021/11/17&#x27; underlying_kind=&#x27;I&#x27; unit=1 limit_up=18256.0 limit_down=14938.0 reference=16597.0 update_date=&#x27;2021/10/12&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: 台指期202112: code=&#x27;TXFL1&#x27; symbol=&#x27;TXF202112&#x27; name=&#x27;臺股期貨12&#x27; category=&#x27;TXF&#x27; delivery_month=&#x27;202112&#x27; delivery_date=&#x27;2021/12/15&#x27; underlying_kind=&#x27;I&#x27; unit=1 limit_up=18225.0 limit_down=14913.0 reference=16569.0 update_date=&#x27;2021/10/12&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: 台指期202206: code=&#x27;TXFF2&#x27; symbol=&#x27;TXF202206&#x27; name=&#x27;臺股期貨06&#x27; category=&#x27;TXF&#x27; delivery_month=&#x27;202206&#x27; delivery_date=&#x27;2022/06/15&#x27; underlying_kind=&#x27;I&#x27; unit=1 limit_up=17974.0 limit_down=14706.0 reference=16340.0 update_date=&#x27;2021/10/12&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>上面所取得的資訊，其中<code>delivery_date</code>指的則是結算日期，為當月份的<strong>第三個星期三</strong>。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="訂閱subscribe期貨來看看即時報價quote資料">訂閱(Subscribe)期貨來看看即時報價(Quote)資料<a class="hash-link" href="#訂閱subscribe期貨來看看即時報價quote資料" title="標題的直接連結">​</a></h4><p>台股只有白天上時間有即時交易資料，下班後如果要測試驗證即時的訂閱資料，只能看期貨的<strong>夜盤</strong>資料。</p><p>期貨的一般交易時間，為<strong>8:40~13:45</strong>，而盤後交易時間為<strong>15:00~5:00</strong>(凌晨)。
剛剛介紹完Contracts後，下一個動作可以試著將一個Contract進行<strong>報價(Quote)</strong>的訂閱，並指定我們要訂閱的是Ticks每檔成交資料，或是BidAsk委買委賣的委託資料。</p><p>下面只列出較重要的程式段：</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> shioaji </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> TickFOPv1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> BidAskFOPv1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Exchange</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@api</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">on_tick_fop_v1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">quote_callback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">exchange</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Exchange</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tick</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> TickFOPv1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Exchange: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">exchange</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">, Tick: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">tick</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@api</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">on_bidask_fop_v1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">quote_callback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">exchange</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Exchange</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bidask</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> BidAskFOPv1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Exchange: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">exchange</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">, BidAsk: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">bidask</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@api</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">quote</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">on_event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">event_callback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">resp_code</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event_code</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> info</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&#x27;Response code: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">resp_code</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> | Event code: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">event_code</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> | Event: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">event</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">### 使用decorator方式，以下兩行都不需要再定義了</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># api.quote.set_callback(quote_callback)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># api.quote.set_event_callback(event_callback)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ftu_txf2110 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Contracts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Futures</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TXF</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TXF202110</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">quote</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ftu_txf2110</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    quote_type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">sj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">constant</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">QuoteType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Tick</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    version</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">sj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">constant</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">QuoteVersion</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">quote</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ftu_txf2110</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    quote_type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">sj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">constant</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">QuoteType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">BidAsk</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    version</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">sj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">constant</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">QuoteVersion</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    i </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">logout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>這邊有幾個需要特別說明的程式，首先我們先了解一下quote和subscribe。我們想要針對一個Contracts去取得其即時報價資料，則需使用<code>api.quote.subscribe()</code>告知我們要訂閱報價訊息，而參數則需明白指名要訂閱的：</p><ol><li>哪一個Contract (可事先放入變數)</li><li>報價型態：可以是每檔成交Ticks，或者是委買Bid、委賣Ask的即時資訊。</li><li>報價格式版本：目前官網有<code>v0</code>與<code>v1</code>兩種版本，預設是<code>v0</code>。</li></ol><p>官方格式說明如下，如果是股票的話還可指定是否要特別看<strong>盤中零股 (intraday_odd)</strong>的報價</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">quote_type: tick price or bid/ask price to subscribe.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {&#x27;tick&#x27;, &#x27;bidask&#x27;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">intraday_odd: 盤中零股</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {True, False}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">version: version of quote format.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {&#x27;v1&#x27;, &#x27;v0&#x27;}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>所以以我們的例子，我們選定了contract為大台指2021年10月份，然後訂閱了他的Tick以及BidAsk的報價。(大人任性地都要！小孩才作選擇呀~)</p><p>接著要說明的是，Shioaji採用的方式是訂閱時，需要指定其callback回呼函式。分別以event和實際quote報價結果都需要接收callback函式。</p><p>而以官網寫有提供的方式，可採用python function decorator <code>@api.on_tick_fop_v1()</code>和<code>@api.on_bidask_fop_v1()</code>以及<code>@api.quote.on_event</code>來直接定義這個函式就是作為報價的回呼函式，相較傳統作法，就無需再額外定義callback的設定：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">from shioaji import TickFOPv1, BidAskFOPv1, Exchange</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@api.on_tick_fop_v1()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def quote_callback(exchange: Exchange, tick: TickFOPv1):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;Exchange: {exchange}, Tick: {tick}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@api.on_bidask_fop_v1()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def quote_callback(exchange: Exchange, bidask: BidAskFOPv1):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;Exchange: {exchange}, BidAsk: {bidask}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@api.quote.on_event</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def event_callback(resp_code: int, event_code: int, info: str, event: str):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&#x27;Response code: {resp_code} | Event code: {event_code} | Event: {event}&#x27;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>記得使用前，要引入<code>TickFOPv1</code>, <code>BidAskFOPv1</code>, <code>Exchange</code>。</p><p>如此一來，只要有即時資料進來，就會自動跑進那幾個callback functions。
我們程式碼裡，簡單每秒鐘睡一下，讓程式可以跑個10秒鐘再進行logout。</p><p>所以我們就可以看到以下的<strong>台指期202110</strong>的即時Tick與BidAsk資料瘋狂湧入！好開心呀！
篇幅問題，我們就簡單列個幾筆：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Response code: 200 | Event code: 16 | Event: Subscribe or Unsubscribe ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Response code: 200 | Event code: 16 | Event: Subscribe or Unsubscribe ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Exchange: TAIFEX, BidAsk: BidAsk(code=&#x27;TXFJ1&#x27;, datetime=datetime.datetime(2021, 10, 12, 23, 42, 18, 759000), bid_total_vol=63, ask_total_vol=71, bid_price=[Decimal(&#x27;16496&#x27;), Decimal(&#x27;16495&#x27;), Decimal(&#x27;16494&#x27;), Decimal(&#x27;16493&#x27;), Decimal(&#x27;16492&#x27;)], bid_volume=[1, 6, 9, 25, 22], diff_bid_vol=[0, -1, 0, 0, 0], ask_price=[Decimal(&#x27;16497&#x27;), Decimal(&#x27;16498&#x27;), Decimal(&#x27;16499&#x27;), Decimal(&#x27;16500&#x27;), Decimal(&#x27;16501&#x27;)], ask_volume=[4, 16, 15, 13, 23], diff_ask_vol=[0, 0, 1, 0, 0], first_derived_bid_price=Decimal(&#x27;0&#x27;), first_derived_ask_price=Decimal(&#x27;16501&#x27;), first_derived_bid_vol=0, first_derived_ask_vol=1, underlying_price=Decimal(&#x27;16462.84&#x27;), simtrade=0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Exchange: TAIFEX, Tick: Tick(code=&#x27;TXFJ1&#x27;, datetime=datetime.datetime(2021, 10, 12, 23, 42, 18, 770000), open=Decimal(&#x27;16389&#x27;), underlying_price=Decimal(&#x27;16462.84&#x27;), bid_side_total_vol=22359, ask_side_total_vol=23121, avg_price=Decimal(&#x27;16500.63133&#x27;), close=Decimal(&#x27;16496&#x27;), high=Decimal(&#x27;16563&#x27;), low=Decimal(&#x27;16378&#x27;), amount=Decimal(&#x27;16496&#x27;), total_amount=Decimal(&#x27;583231315&#x27;), volume=1, total_volume=35346, tick_type=2, chg_type=2, price_chg=Decimal(&#x27;77&#x27;), pct_chg=Decimal(&#x27;0.468969&#x27;), simtrade=0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Exchange: TAIFEX, BidAsk: BidAsk(code=&#x27;TXFJ1&#x27;, datetime=datetime.datetime(2021, 10, 12, 23, 42, 18, 884000), bid_total_vol=72, ask_total_vol=73, bid_price=[Decimal(&#x27;16495&#x27;), Decimal(&#x27;16494&#x27;), Decimal(&#x27;16493&#x27;), Decimal(&#x27;16492&#x27;), Decimal(&#x27;16491&#x27;)], bid_volume=[3, 7, 15, 31, 16], diff_bid_vol=[-3, -2, -10, 9, 0], ask_price=[Decimal(&#x27;16497&#x27;), Decimal(&#x27;16498&#x27;), Decimal(&#x27;16499&#x27;), Decimal(&#x27;16500&#x27;), Decimal(&#x27;16501&#x27;)], ask_volume=[6, 16, 15, 13, 23], diff_ask_vol=[2, 0, 0, 0, 0], first_derived_bid_price=Decimal(&#x27;0&#x27;), first_derived_ask_price=Decimal(&#x27;16501&#x27;), first_derived_bid_vol=0, first_derived_ask_vol=1, underlying_price=Decimal(&#x27;16462.84&#x27;), simtrade=0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Exchange: TAIFEX, BidAsk: BidAsk(code=&#x27;TXFJ1&#x27;, datetime=datetime.datetime(2021, 10, 12, 23, 42, 19, 9000), bid_total_vol=61, ask_total_vol=72, bid_price=[Decimal(&#x27;16496&#x27;), Decimal(&#x27;16495&#x27;), Decimal(&#x27;16494&#x27;), Decimal(&#x27;16493&#x27;), Decimal(&#x27;16492&#x27;)], bid_volume=[2, 4, 8, 25, 22], diff_bid_vol=[1, 1, 1, 10, -9], ask_price=[Decimal(&#x27;16497&#x27;), Decimal(&#x27;16498&#x27;), Decimal(&#x27;16499&#x27;), Decimal(&#x27;16500&#x27;), Decimal(&#x27;16501&#x27;)], ask_volume=[5, 16, 15, 13, 23], diff_ask_vol=[-1, 0, 0, 0, 0], first_derived_bid_price=Decimal(&#x27;0&#x27;), first_derived_ask_price=Decimal(&#x27;16501&#x27;), first_derived_bid_vol=0, first_derived_ask_vol=1, underlying_price=Decimal(&#x27;16462.84&#x27;), simtrade=0)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>順帶一提的是，在永豐講師課程中有提到，目前操作上可允許的訂閱數為<strong>100則</strong>，像上面我們剛剛的例子，即使是同一個期貨標的，訂閱了Tick和BidAsk的報價，就用掉了<strong>2則</strong>訂閱數。</p><p>所以要作好訂閱的資源管理，若有不需使用的訂閱則可用<code>unsubscribe()</code>進行解除訂閱。</p><p>以上先以期貨作為例子，股票的結果相信是差不多的，但上班時間沒辦法操作，所以先以期貨來作代表！</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="補充一下">補充一下<a class="hash-link" href="#補充一下" title="標題的直接連結">​</a></h4><p>說明一下，目前永豐的文件，如同前面有提到一個Basic Overview的講師叮嚀必看內容，由於其版本較舊，因此裡面有一些用法和最新的Shioaji的規格文件會稍有不同，請以最新的規格內容來撰寫較恰當。</p><p>另外，如果你要訂閱即時報價，例如，本月份是202110，請使用<strong>TXF202110</strong>；雖然<strong>TXFR1台指期近一</strong>也是202110 (2021年10月)，但訂閱近一這個是沒辦法取得即時報價的。</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件分頁導覽"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/finance-bank-api/Day27 - 永豐線上收款支付API功能實作總結3 - 如何讓機敏性設定值更有保護力"><div class="pagination-nav__sublabel">上一頁</div><div class="pagination-nav__label">Day27 - 永豐線上收款支付API功能實作總結3 - 如何讓機敏性設定值更有保護力</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/finance-bank-api/Day29 - Shioaji - 超入門！永豐證券程式交易API快速上手 2"><div class="pagination-nav__sublabel">下一頁</div><div class="pagination-nav__label">Day29 - Shioaji - 超入門！永豐證券程式交易API快速上手 2</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#什麼是shioaji" class="table-of-contents__link toc-highlight">什麼是Shioaji</a></li><li><a href="#來吧先架設環境" class="table-of-contents__link toc-highlight">來吧！先架設環境</a></li><li><a href="#開始來嘗試第一支最簡單的範例" class="table-of-contents__link toc-highlight">開始來嘗試第一支最簡單的範例</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Code Tenshu</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog文章</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/intro">系列文章</a></li></ul></div><div class="col footer__col"><div class="footer__title">My Hobbies</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.facebook.com/rainfieldcoco/" target="_blank" rel="noopener noreferrer" class="footer__link-item">雨田良可 | 攝影集<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">About Me</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/aboutme">誰是雷哥</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Code Tenshu 程式技術天守閣.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.198d87d1.js"></script>
<script src="/assets/js/main.3f91edfd.js"></script>
</body>
</html>